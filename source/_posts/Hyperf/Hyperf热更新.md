---
title: Hyperfçƒ­æ›´æ–°
tags:
    - PHP
    - Swoole
    - Hyperf
date: 2020-10-28 14:56:45
categories:
    - PHP
---

æœ¬æ–‡ç¼–å†™äº `2020-10-28`ï¼Œéƒ¨åˆ†è§‚ç‚¹å¯èƒ½å·²ç»è¿‡æ—¶ã€‚

## å‰è¨€

æœ€è¿‘æƒ³åœ¨æ–°é¡¹ç›®ä¸­ä½¿ç”¨ `Hyperf`ï¼Œä½†æ˜¯åœ¨å°è¯•æ²¡å¤šä¹…ä¹‹åï¼Œå°±é‡åˆ°äº†å„ç§é—®é¢˜ã€‚

å…¶ä¸­æ¯”è¾ƒå¤´ç–¼çš„å°±æ˜¯çƒ­æ›´æ–°ã€‚

## æ–¹æ¡ˆ

### æ‰‹åŠ¨åœæ­¢ã€å¯åŠ¨é¡¹ç›®

è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒç´¯çš„å·¥ä½œã€‚

### ä½¿ç”¨IDEç›‘æµ‹æ–‡ä»¶çš„ä¿å­˜

å¤§éƒ¨åˆ† `IDE` ä¸­éƒ½å­˜åœ¨è¿™ä¸ªåŠŸèƒ½ã€‚

`Sublime` åœ¨è¿™æ–¹é¢å¹¶ä¸æ˜¯å¾ˆå‹å¥½ï¼Œå½“ç„¶ï¼Œå¯¹äºå¤§ç¥çº§åˆ«çš„åº”è¯¥ä¸æ˜¯é—®é¢˜ã€‚

### æ‰‹åŠ¨ç¼–è¯‘

å› ä¸ºæˆ‘ç”¨çš„æ˜¯ `Sublime`ï¼Œæ‰€ä»¥æˆ‘è¿™è¾¹ä¸¾ä¸€ä¸ª `Sublime` çš„ä¾‹å­ã€‚

é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªç¼–è¯‘ç³»ç»Ÿã€‚`Tools` -> `Build System` -> `New Build System...`

![æ·»åŠ ç¼–è¯‘ç³»ç»Ÿ](/media/Hyperf/image-20201028150434107.png)

æ¥ç€ï¼Œç¼–å†™æ‰§è¡Œæ—¶éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚(æˆ‘æœ¬åœ°ä½¿ç”¨çš„æ˜¯ `Docker`ï¼Œåªéœ€è¦é‡å¯å®¹å™¨å°±å¥½)

![ç¼–å†™ç¼–è¯‘æ—¶è¦æ‰§è¡Œçš„å‘½ä»¤](/media/Hyperf/image-20201028150635375.png)

æ¥ç€ï¼Œä¿å­˜ä¸º `Hyperf.sublime-build`ã€‚å¹¶é€‰æ‹© `Hyperf` ä½œä¸ºç¼–è¯‘ç³»ç»Ÿã€‚

![é€‰æ‹©è‡ªå®šä¹‰ç¼–è¯‘ç³»ç»Ÿ](/media/Hyperf/image-20201028150924880.png)

æœ€åï¼Œç¼–å†™å®Œä»£ç ä¹‹åï¼Œ`Ctrl+B` ä¸€é”®ç¼–è¯‘ã€‚

![ç¼–è¯‘ç»“æœ](/media/Hyperf/image-20201028151215465.png)

### ä½¿ç”¨watchæ”¹é€ 

åŸºäº `Swoole` çš„ `Process/Timer/Event` å®ç°ï¼Œå®šæ—¶æ‰«ææ–‡ä»¶å¹¶ç›‘å¬æ–‡ä»¶å˜åŠ¨é‡å¯æœåŠ¡ã€‚

ä¸ä¾èµ–å…¶å®ƒæ‰©å±•ï¼Œæ€§èƒ½è¡¨ç°ä¸€èˆ¬ï¼Œå…¨å¹³å°å¯ç”¨ï¼Œä½“éªŒè¾ƒå¥½ï¼ˆå¯åœ¨æ§åˆ¶å°ç›´æ¥è¾“å‡ºè¿è¡Œæ—¥å¿—ï¼‰ã€‚

ä¸‹è½½åœ°å€ï¼š[Github ä¼ é€é—¨](https://github.com/ha-ni-cc/hyperf-watch)

ä½¿ç”¨æ–¹å¼ï¼š

1. å¤åˆ¶ `watch` æ–‡ä»¶åˆ°é¡¹ç›®æ ¹ç›®å½•ï¼Œå³ `bin` ç›®å½•æ‰€åœ¨çš„é‚£ä¸€å±‚ã€‚

2. å¯åŠ¨

   ```bash
   php watch -c
   ```

å¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼š

åœ¨ `Docker` ä¸­ï¼Œä¸€ç›´å› ä¸º `9501` ç«¯å£è¢«ç›‘å¬ï¼Œå¯¼è‡´é‡å¯ `Hyperf` å¤±è´¥ã€‚

è§£å†³æ–¹å¼ï¼š

ä¿®æ”¹ `@change` æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š

```php
function change()
{
    global $serve;
    echo CONSOLE_COLOR_YELLOW . "ğŸ”„ Restart @ " . date('Y-m-d H:i:s') . PHP_EOL;
    // Process::kill($serve->pid);
    shell_exec('kill -9 ' . $serve->pid);
    start();
}
```

